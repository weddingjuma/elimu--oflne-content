function titleCase(e){if(null!==e){for(var s=e.toLowerCase().split(" "),t=0;t<s.length;t++)s[t]=s[t].charAt(0).toUpperCase()+s[t].substring(1);return s.join(" ")}}function capitalizeUsername(){if(null!==localStorage.getItem("user")){var e=titleCase(localStorage.getItem("user"));userNameSection.empty(),userNameSection.prepend(e+"&nbsp;&nbsp;")}}function logout(){"undefined"!=typeof localStorage.getItem("auth")&&null!==localStorage.getItem("auth")?$("#student-logout").on("click",function(){localStorage.removeItem("auth"),localStorage.removeItem("user"),$("#register-success").empty(),$("#student-account-section").css("visibility","hidden"),window.location.href="/exams"}):$("#student-account-section").css("visibility","hidden")}function titleCase(e){if(null!==e){for(var s=e.toLowerCase().split(" "),t=0;t<s.length;t++)s[t]=s[t].charAt(0).toUpperCase()+s[t].substring(1);return s.join(" ")}}var userNameSection=$("#menu");capitalizeUsername(),logout(),$(function(){function e(){$.ajax({type:"GET",url:"api/countries/",dataType:"json",success:function(e){sessionStorage.setItem("countries",JSON.stringify(e))}})}var s=$(".cssload-loader");e();var t=localStorage.auth;void 0!==t&&$.ajax({type:"GET",url:"api/profile/",dataType:"json",cache:!1,headers:{Authorization:"Token "+t,"Cache-Control":"no-cache"},success:function(e){localStorage.setItem("currentStudentDetails",JSON.stringify(e))}}),$.ajax({type:"GET",url:"api/subjects/",dataType:"json",success:function(e){s.css("visibility","hidden"),$("#footer").css("display","none");var t=e;t.reverse();var n=$("#lead-wrapper");n.css("text-align","center"),n.css("font-size","1.2em"),n.css("line-height","1.2em"),n.css("margin-top","30px"),$("#lead-instruction").html('<span id="choose-paper"></span>'),$("#choose-paper").css("font-size","1.4em"),$("#choose-paper").css("font-weight","bold"),$("#choose-paper").css("color","#fff"),$("#choose-paper").append("Choose a subject"),$.each(t,function(e,s){function t(){function e(){t.sort(function(e,s){var t=e.name,n=s.name;return t>n?-1:n>t?1:0});var e=t.length;0!==e?$.each(t,function(e,s){function a(){var a=$("#lead-wrapper");a.css("text-align","center"),a.css("font-size","1.2em"),a.css("line-height","1.2em"),$("#lead-instruction").html('<span id="choose-paper"></span>'),$("#choose-paper").css("font-size","1.4em"),$("#choose-paper").css("font-weight","bold"),$("#choose-paper").css("color","#fff"),$("#choose-paper").append("Choose a paper");var r=s.name,c=s.id,d=e,p='<br><button class="btn btn-primary btn-exam" id="exam-'+d+'">'+r+"</button><br>";i.append(p),examToDone=$("#exam-"+d),examToDone.on("click",function(){function a(){reversedQuestions=h.reverse(),reversedQuestions.reverse(),reversedQuestions.sort(function(e,s){return e.question_number-s.question_number}),numberOfQuestions=Object.keys(h).length,l.html(""),questionDetailsDiv=$("#question-listing"),questionNumber=$("#question-number");var s=h[b].image_resources[0];if(void 0!==s){var o=reversedQuestions[b].statement,a=o.match(/\[resource\:\s\d+,\s\align\:\s\left\]/);replacedStatement=o.replace(a,'<img src="'+s.avatar+'"  alt="image not loaded">')}else replacedStatement=reversedQuestions[b].statement;questionNumber.html(reversedQuestions[b].question_number+"&nbsp;&nbsp;of&nbsp;&nbsp;"+numberOfQuestions),"IRE"===n||"CRE"===n||"HRE"===n?(no_of_questions=60+parseInt(numberOfQuestions),questionNumber.html(reversedQuestions[b].question_number+"&nbsp;&nbsp;of&nbsp;&nbsp;"+no_of_questions)):questionNumber.html(reversedQuestions[b].question_number+"&nbsp;&nbsp;of&nbsp;&nbsp;"+numberOfQuestions),questionDetailsDiv.empty(),null!==reversedQuestions[b].text_resource&&reversedQuestions[b].question_number<16&&(storedTR=hashTableTR.retrieve(t[e].text_resources[0].id),null===storedTR?(trId=t[e].text_resources[0].id,trStatement=t[e].text_resources[0].statement,hashTableTR.insert(trId,trStatement),questionDetailsDiv.append('<div id="close-text">'+hashTableTR.retrieve(trId)+"</div>")):questionDetailsDiv.append('<div id="close-text">'+hashTableTR.retrieve(trId)+"</div>")),null!==reversedQuestions[b].text_resource&&reversedQuestions[b].question_number>25&&reversedQuestions[b].question_number<39&&questionDetailsDiv.append(t[e].text_resources[1].statement),null!==reversedQuestions[b].text_resource&&reversedQuestions[b].question_number>38&&reversedQuestions[b].question_number<51&&questionDetailsDiv.append(t[e].text_resources[2].statement),questionDetailsDiv.append(replacedStatement),MathJax.Hub.Queue(["Typeset",MathJax.Hub,"#lead-instruction"]),choicesObj=reversedQuestions[b].choices;var i=choicesObj.choices_image,r=choicesObj.A,c=r.replace("<p>","").replace("</p>",""),d=choicesObj.B,p=d.replace("<p>","").replace("</p>",""),u=choicesObj.C,m=u.replace("<p>","").replace("</p>",""),g=choicesObj.D,v=g.replace("<p>","").replace("</p>",""),f=i[0],w=i[1],y=i[2],x=i[3];if(void 0!==f){var _=c.match(/\[resource\:\s\d+,\s\align\:\s\left\]/);replacedA=c.replace(_,'<img class="img img-responsive" src="'+f.image_url+'">')}else replacedA=c;if(void 0!==w){var C=p.match(/\[resource\:\s\d+,\s\align\:\s\left\]/);replacedB=p.replace(C,'<img class="img img-responsive" src="'+w.image_url+'">')}else replacedB=p;if(void 0!==y){var T=m.match(/\[resource\:\s\d+,\s\align\:\s\left\]/);replacedC=m.replace(T,'<img class="img img-responsive" src="'+y.image_url+'">')}else replacedC=m;if(void 0!==x){var k=v.match(/\[resource\:\s\d+,\s\align\:\s\left\]/);replacedD=v.replace(k,'<img class="img img-responsive" src="'+x.image_url+'">')}else replacedD=v;var q='<div class="answer-btn" id="A">'+replacedA+'</div><div class="answer-btn" id="B">'+replacedB+'</div><div class="answer-btn" id="C">'+replacedC+'</div><div class="answer-btn" id="D">'+replacedD+"</div>";questionDetailsDiv.append(q),MathJax.Hub.Queue(["Typeset",MathJax.Hub,"#lead-instruction"]),wheelzoom(document.querySelectorAll("img"),{zoom:.05})}function p(){$("#A").on("click",function(){void 0!==v&&(v=v.replace(openText,$(this).text()),openText=$(this).text(),hashTableTR.insert(trId,v),g.html(hashTableTR.retrieve(trId))),$(this).css("background-color","#6bc8c4"),$("#B").css("background-color","#436bb3"),$("#C").css("background-color","#436bb3"),$("#D").css("background-color","#436bb3")}),$("#B").on("click",function(){void 0!==v&&(v=v.replace(openText,$(this).text()),openText=$(this).text(),hashTableTR.insert(trId,v),g.html(hashTableTR.retrieve(trId))),$(this).css("background-color","#6bc8c4"),$("#A").css("background-color","#436bb3"),$("#C").css("background-color","#436bb3"),$("#D").css("background-color","#436bb3")}),$("#C").on("click",function(){void 0!==v&&(v=v.replace(openText,$(this).text()),openText=$(this).text(),hashTableTR.insert(trId,v),g.html(hashTableTR.retrieve(trId))),$(this).css("background-color","#6bc8c4"),$("#B").css("background-color","#436bb3"),$("#A").css("background-color","#436bb3"),$("#D").css("background-color","#436bb3")}),$("#D").on("click",function(){void 0!==v&&(v=v.replace(openText,$(this).text()),openText=$(this).text(),hashTableTR.insert(trId,v),g.html(hashTableTR.retrieve(trId))),$(this).css("background-color","#6bc8c4"),$("#B").css("background-color","#436bb3"),$("#C").css("background-color","#436bb3"),$("#A").css("background-color","#436bb3")})}function u(){var e='<div class="row  btn-alignment"><div class="col-sm-4 col-xs-4"><div class="btn" id="back-btn"><img class="img-responsive btn-img" src="https://elimufeynman.s3-us-west-2.amazonaws.com/static/exams/images/back-arrow-orange-144.png"></div></div><div class="col-sm-4 col-xs-4 timing" style="font-size: .8em; color: #000">'+r+'</div><div class="col-sm-4 col-xs-4 "><div class="btn" id="next-btn"><img class="img-responsive btn-img" src="https://elimufeynman.s3-us-west-2.amazonaws.com/static/exams/images/next-arrow-orange-144.png"></div></div></div>';questionDetailsDiv.append(e),nextBtn=$("#next-btn"),backBtn=$("#back-btn"),0===b&&backBtn.css("visibility","hidden"),$('input[name="answer"]').attr("checked",!1)}function m(){var e=choicesObj.answer;e=e.toUpperCase(),e==selectedChoiceId?choice=1:choice=0}var b=0;if(null!==localStorage.getItem("auth")){var h=t[d].questions;$.ajax({type:"GET",url:"api/attempt/",dataType:"json",success:function(e){attemptId=e}}),i.html('<div class="row"><div class="col-sm-2"></div><div class="col-sm-8 question-background" style="min-height: 400px;"><br><div class="qn-heading">Question&nbsp;&nbsp;<span id="question-number"></span>&nbsp;&nbsp;|&nbsp;&nbsp;<span id="timer" style="color: grey; font-weight: lighter; font-size: 1em"></span></div><br><div id="question-listing"></div></div><div class="col-sm-2"></div></div>'),hashTableTR=new HashTable,a();var g=$("#close-text"),v=g.html();if(void 0!==v&&(openText=v.match(/_+?\d+_+/)),p(),numberOfQuestions>0){u(),hashTableChoice=new HashTable,hashTableAnswer=new HashTable,i.on("click",".answer-btn",function(){selectedChoiceId=$(this).attr("id"),m(),hashTableChoice.insert(b,selectedChoiceId),hashTableAnswer.insert(b,choice)});var f=$("#timer");$.notify("Timer started","success",{position:"center"}),f.timer(),i.on("click","#next-btn",function(){if(b++,b<numberOfQuestions)a(),p(),g=$("#close-text"),v=g.html(),void 0!==v&&(openText=v.match(/_+?\d+_+/)),u();else{var e=f.data("seconds"),t=(new Date).clearTime().addSeconds(e).toString("H:mm:ss");hashTableChoice.retrieveAll();var i=content[0];hashTableAnswer.retrieveAll();var l=content[0],d={},m={};if(void 0!==l||void 0!==i){i.forEach(function(e){d[e[0]]=e[1]}),l.forEach(function(e){m[e[0]]=e[1]});for(var w=0,y=b,x=[],_=[],C=new HashTable,T=w;y+1>T;T++){var k=hashTableAnswer.retrieve(T);x.push(k);var q=hashTableChoice.retrieve(T);_.push(T),C.insert(T,q)}for(var S=0,D=0;D<x.length;D++)S+=x[D]<<0;var I=Math.ceil(S/numberOfQuestions*100),A=$(".qn-heading");A.css("color","#ed5729");var j=localStorage.getItem("currentStudentDetails"),O=(JSON.parse(j),"");O=I>74?"Excellent":I>59&&75>I?"Very Good":I>44&&60>I?"Good":I>29&&45>I?"Fair":"Nice Try";var Q="";Q=I>79?"A":I>74&&80>I?"A-":I>69&&75>I?"B+":I>64&&70>I?"B":I>59&&65>I?"B-":I>54&&60>I?"C+":I>49&&55>I?"C":I>45&&50>I?"C-":I>39&&45>I?"D+":I>34&&40>I?"D":I>29&&35>I?"D-":"E",A.html('<div class="row"><div class="col-sm-12" style="color: #436bb3;font-weight: bolder; margin-left: auto; margin-right: auto;">'+r+'</div><br><br><div class="col-sm-2 col-xs-2"></div><div class="col-sm-8 col-xs-8"><span style="font-weight: bolder">'+O+"&nbsp;"+titleCase(localStorage.user)+'!</span><br><span class="percentage" style="font-weight: bolder">'+I+'%</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="percentage" style="font-weight: 400">'+Q+'</span><br><span class="scoredOutOf" style="font-weight: bolder">'+S+"/"+numberOfQuestions+'</span>&nbsp;<span style="font-weight: 400">in</span>&nbsp;<span style="font-weight: bolder">'+t+'</span><br><span style="font-size: 1em; color: #436bb3; "><a href="/exams"><span>Take another exam</span></a></span></div><div class="col-sm-2 col-xs-2"></div></div>');var R=_.length;if(0!==R){questionDetailsDiv.html('<div class="row"><div class="col-sm-12"><p style="color: #436bb3; font-weight: bold; margin-left: auto; margin-right: auto;">Check out all the answers </p></div></div>');var B=0;h.sort(function(e,s){return e.question_number-s.question_number});for(var E=B;E<h.length;E++){var J=h[_[E]];console.log(J);var z,M=J.image_resources[0],N=J.statement;if(void 0!==N)if(void 0!==M&&void 0!==N){var W=N.match(/\[resource\:\s\d+,\s\align\:\s\left\]/);z=N.replace(W,'<img src="'+M.avatar+'">')}else z=J.statement;var L=C.retrieve(_[E]);null!==L?hashedChoice=L:hashedChoice=L;var H=J.choices.A,P=J.choices.B,U=J.choices.C,G=J.choices.D,Y=J.choices.choices_image[0],K=J.choices.choices_image[1],V=J.choices.choices_image[2],F=J.choices.choices_image[3],X=new HashTable;if(void 0!==Y){var Z=H.match(/\[resource\:\s\d+,\s\align\:\s\left\]/);replacedChoiceA=H.replace(Z,'<img class="img img-responsive" src="'+Y.image_url+'">'),X.insert("A",replacedChoiceA)}else replacedChoiceA=H;if(void 0!==K){var ee=P.match(/\[resource\:\s\d+,\s\align\:\s\left\]/);replacedChoiceB=P.replace(ee,'<img class="img img-responsive" src="'+K.image_url+'">'),X.insert("B",replacedChoiceB)}else replacedChoiceB=P;if(void 0!==V){var se=U.match(/\[resource\:\s\d+,\s\align\:\s\left\]/);replacedChoiceC=U.replace(se,'<img class="img img-responsive" src="'+V.image_url+'">'),X.insert("C",replacedChoiceC)}else replacedChoiceC=U;if(void 0!==F){var te=G.match(/\[resource\:\s\d+,\s\align\:\s\left\]/);replacedChoiceD=G.replace(te,'<img class="img img-responsive" src="'+F.image_url+'">'),X.insert("D",replacedChoiceD)}else replacedChoiceD=G;var ne=J.choices.answer,oe=ne.toUpperCase(),ae=J.choices[oe];CAMatchImage=ae.match(/\[resource\:\s\d+,\s\align\:\s\left\]/),null!==CAMatchImage?replacedCA=X.retrieve(oe):replacedCA=ae.replace("<p>","").replace("</p>","");var ie=J.choices[hashedChoice];void 0!==ie?matchWrongChoiceImage=ie.match(/\[resource\:\s\d+,\s\align\:\s\left\]/):matchWrongChoiceImage=null;var re,le,ce=ie,de=J.topic;null!==de&&(re=de.id,le=de.title);var pe,ue=J.topic;if(null!==ue&&(pe=J.topic.chapter),null!==matchWrongChoiceImage)answeredWrong=X.retrieve(hashedChoice);else if(void 0!==ce){var me=ce.replace("<p>","").replace("</p>","");0===hashTableAnswer.retrieve(E)?"Kiswahili"===n?(answeredWrong='<span style="color:  #ed5729; font-weight: bold;">'+me+"</span>",answeredWrong="Jibu lako lilikuwa: &nbsp;&nbsp;"+answeredWrong,replacedCA='Jibu sahihi ni :&nbsp;&nbsp;&nbsp;&nbsp;<span class="correct-choice">'+replacedCA+"</span>",learnMore='Jifunze zaidi kuhusu:&nbsp;&nbsp;<a href="/topic/view/?t='+re+"&c="+pe+' " id='+J.id+' target="_blank">'+le+"</a>"):(answeredWrong='<span style="color:  #ed5729; font-weight: bold;">'+me+"</span>",answeredWrong="Your answer was: &nbsp;&nbsp;"+answeredWrong,replacedCA='The correct answer is:&nbsp;&nbsp;&nbsp;&nbsp;<span class="correct-choice">'+replacedCA+"</span>",learnMore='Learn more about:&nbsp;&nbsp;<a href="/topic/view/?t='+re+"&c="+pe+' " id='+J.id+' target="_blank">'+le+"</a>"):"Kiswahili"===n?(answeredWrong='<span style="color: #436bb3; font-weight: bold;">'+me+"</span>",answeredWrong="Jibu lako lilikuwa: &nbsp;&nbsp;"+answeredWrong,learnMore='Jifunze zaidi kuhusu:&nbsp;&nbsp;<a href="/topic/view/?t='+re+"&c="+pe+' " id='+J.id+' target="_blank">'+le+"</a>",replacedCA='Jibu sahihi ni :&nbsp;&nbsp;&nbsp;&nbsp;<span class="correct-choice">'+replacedCA+"</span>"):(answeredWrong='<span style="color: #436bb3; font-weight: bold;">'+me+"</span>",answeredWrong="Your answer was: &nbsp;&nbsp;"+answeredWrong,learnMore='Learn more about:&nbsp;&nbsp;<a href="/topic/view/?t='+re+"&c="+pe+' " id='+J.id+' target="_blank">'+le+"</a>",replacedCA='The correct answer is:&nbsp;&nbsp;&nbsp;&nbsp;<span class="correct-choice">'+replacedCA+"</span>")}else"Kiswahili"===n?(answeredWrong='<span tab style="color: red">Hukujaribu swali hili.<span>',learnMore='Jifunze zaidi kuhusu::&nbsp;&nbsp;<a href="/topic/view/?t='+re+"&c="+pe+' " id='+J.id+' target="_blank">'+le+"</a>",replacedCA='Jibu sahihi ni :&nbsp;&nbsp;&nbsp;&nbsp;<span class="correct-choice">'+replacedCA+"</span>"):(answeredWrong='<span tab style="color: red">You skipped this question.<span>',learnMore='Learn more about:&nbsp;&nbsp;<a href="/topic/view/?t='+re+"&c="+pe+' " id='+J.id+' target="_blank">'+le+"</a>",replacedCA='The correct answer is:&nbsp;&nbsp;&nbsp;&nbsp;<span class="correct-choice">'+replacedCA+"</span>");questionDetailsDiv.append("<br>"),null!==J.text_resource&&J.question_number<16&&questionDetailsDiv.append('<div class="wrongQuestionView">'+s.text_resources[0].statement+"</div>"),null!==J.text_resource&&J.question_number>25&&J.question_number<39&&questionDetailsDiv.append(s.text_resources[1].statement),null!==J.text_resource&&J.question_number>38&&J.question_number<51&&questionDetailsDiv.append(s.text_resources[2].statement),MathJax.Hub.Queue(["Typeset",MathJax.Hub,"#lead-instruction"]),"IRE"===n||"CRE"===n||"HRE"===n?(qs_no=J.question_number,qs_no_statement='<span style="font-weight: bold; margin-top: 5px; margin-bottom: 5px; line-height: 2em;">'+qs_no+".&nbsp;</span>"):"Kiswahili"===n?(qs_no=J.question_number,qs_no_statement='<span style="font-weight: bold; margin-top: 5px; margin-bottom: 5px; line-height: 2em;">'+qs_no+".&nbsp;</span>"):(qs_no=J.question_number,qs_no_statement='<span style="font-weight: bold; margin-top: 5px; margin-bottom: 5px; line-height: 2em;">'+qs_no+". &nbsp;</span>"),z=z.replace("<p>","").replace("</p>","");var be='<div class="wrongQuestionView" >'+qs_no_statement+z+"<tab>"+replacedChoiceA+"</tab><tab>"+replacedChoiceB+"</tab><tab>"+replacedChoiceC+"</tab><tab>"+replacedChoiceD+'</tab><div class="wcs">'+answeredWrong+'</div><div class="wcs">'+replacedCA+'</div><div style="text-align: right">'+learnMore+"</div></div>";questionDetailsDiv.append(be)}questionDetailsDiv.append('<br><div style="text-align: "right""><span style="font-size: 1.2em; color: #436bb3; "><a href="/exams"><span>Take another exam</span></a></span></div>');var he=localStorage.user,ge=localStorage.auth,ve={exam:c,subject:o,attempt:attemptId,marks:I,time_taken:e,user:he};console.log(ve),$.ajax({type:"POST",url:"api/save-results/",data:ve,dataType:"json",headers:{Authorization:"Token "+ge},success:function(e){console.log(e)},error:function(){alert("Sorry, a fatal, error occured")}})}else questionDetailsDiv.html("")}else alert("No questions taken")}}),p(),i.on("click","#back-btn",function(){b-=1,a(),p(),u()})}else questionNumber.append("Sorry, no questions set for this exam")}else{i.append('<div class="modal fade" id="login-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none; height: auto; overflow: scroll"><div class="modal-dialog"><div class="modal-content"><div class="modal-header" align="center"><img class="img-circle" id="img_logo" src="/static/exams/images/unlock.png"><button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top: -105px;"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button></div><div id="div-forms"><form id="login-form"><div class="modal-body"><div id="div-login-msg" style="height: auto;"><div id="icon-login-msg" class="glyphicon glyphicon-chevron-right"></div><span id="text-login-msg">Type your username and password.</span></div><input id="login-username" class="form-control" type="text" placeholder="Your username" required><input id="login-password" class="form-control" type="password" placeholder="Your password" required style="margin-bottom: 8%"></div><div class="modal-footer"><div><button type="submit" class="btn btn-primary btn-lg btn-block">Enter</button></div><div><button id="login_lost_btn" type="button" class="btn btn-link">Lost Password?</button><button id="login_register_btn" type="button" class="btn btn-link">Register</button></div></div></form><form id="lost-form" style="display:none;"><div class="modal-body"><div id="div-lost-msg" style="height: auto;"><div id="icon-lost-msg" class="glyphicon glyphicon-chevron-right"></div> <span id="text-lost-msg">Type your e-mail.</span></div><input id="lost_email" class="form-control" type="email" placeholder="E-mail" required style="margin-bottom: 8%"></div><div class="modal-footer"><div><button type="submit" class="btn btn-primary btn-lg btn-block">Send</button></div><div><button id="lost_login_btn" type="button" class="btn btn-link">Log In</button><button id="lost_register_btn" type="button" class="btn btn-link">Register</button></div></div></form><form id="register-form" style="display:none;"><div class="modal-body"><div id="div-register-msg" style="height: auto;"><div id="icon-register-msg" class="glyphicon glyphicon-chevron-right"></div><span id="text-register-msg">Register to compete with other students.</span></div><input id="register_username" class="form-control" type="text" placeholder="Type a username e.g johnjuma" required><input id="register_email_phone" class="form-control " type="text" placeholder="Email or phone number" required><input  id="register_password" class="form-control" type="password" placeholder="Your password"><input id="confirm_register_password" class="form-control" type="password" placeholder="Confirm password" required style="margin-bottom: 8%"></div><div class="modal-footer"><div><button type="submit" class="btn btn-primary btn-lg btn-block">Start!</button></div><div><button id="register_login_btn" type="button" class="btn btn-link">Log In</button><button id="register_lost_btn" type="button" class="btn btn-link">Lost Password?</button></div></div></form></div></div></div></div>'),$(document).ready($("#login-modal").modal("show"));var w=$("#login-form");w.on("submit",function(e){e.preventDefault();var s=$("#login-username").val(),t=$("#login-password").val(),n={username:s.toLowerCase(),password:t};$.ajax({type:"POST",url:"api/login/",data:JSON.stringify(n),contentType:"application/json",success:function(e){function s(e){if(null!==e){for(var s=e.toLowerCase().split(" "),t=0;t<s.length;t++)s[t]=s[t].charAt(0).toUpperCase()+s[t].substring(1);return s.join(" ")}}$("#login-form-content").each(function(){this.reset()}),$("#student-account-section").show(),localStorage.setItem("user",e.username.toLowerCase()),localStorage.setItem("auth",e.key);var t=$("#menu");if(void 0!==localStorage.getItem("user")){var n=s(localStorage.getItem("user"));t.prepend(n+"&nbsp;&nbsp;")}$("#student-account-section").css("visibility","visible"),$(document).ready($("#login-modal").modal("toggle")),null!==localStorage.getItem("auth")&&($("#student-account-section").css("visibility","visible"),$("#student-logout").on("click",function(){localStorage.removeItem("auth"),localStorage.removeItem("user"),$("#student-account-section").css("visibility","hidden"),window.location.href="/exams"})),toastr.options={closeButton:!0,debug:!0,newestOnTop:!0,progressBar:!1,positionClass:"toast-top-center",preventDuplicates:!0,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:0,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut",tapToDismiss:!0},toastr.success("Please click on an exam to continue.")},error:function(e){var s=JSON.parse(e.responseText),t=$("#div-login-msg");$("#div-login-msg").html(s.failed),t.css("color","#000")}})});var y=$("#register-form");y.on("submit",function(e){function s(){var e=$("#register_password").val(),s=$("#confirm_register_password").val(),n=$("#register_password").val().length;if(e!==s)t.html("Sorry, passwords do not match.");else if(4>n)t.html("Sorry, password set is too short.");else{var o=$("#register_username").val(),a=o.toLowerCase();a.match(/\s/g)?$("#div-register-msg").html("Sorry, your username should not have spaces."):a=o.toLowerCase(),studentObj={username:a,email_phone:$("#register_email_phone").val(),password:$("#register_password").val()},$.ajax({type:"POST",url:"api/register/",data:studentObj,dataType:"json",cache:!1,success:function(){loginCredentials={username:a,password:$("#register_password").val()},$.ajax({type:"POST",url:"api/login/",data:JSON.stringify(loginCredentials),contentType:"application/json",success:function(e){function s(e){if(null!==e){for(var s=e.toLowerCase().split(" "),t=0;t<s.length;t++)s[t]=s[t].charAt(0).toUpperCase()+s[t].substring(1);return s.join(" ")}}if(localStorage.setItem("user",e.username.toLowerCase()),localStorage.setItem("auth",e.key),null!==localStorage.getItem("auth")){var t=$("#menu");if(void 0!==localStorage.getItem("user")){var n=s(localStorage.getItem("user"));t.prepend(n+"&nbsp;&nbsp;")}$("#student-account-section").css("visibility","visible"),$("#student-logout").on("click",function(){localStorage.removeItem("auth"),localStorage.removeItem("user"),$("#student-account-section").css("visibility","hidden"),window.location.href="/exams"})}toastr.options={closeButton:!0,debug:!0,newestOnTop:!0,progressBar:!1,positionClass:"toast-top-center",preventDuplicates:!0,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:0,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut",tapToDismiss:!0},toastr.success("Please click on an exam to continue.")}}),$(document).ready($("#login-modal").modal("toggle"))},error:function(e){var s=JSON.parse(e.responseText);t.html(s.error)}})}}e.preventDefault();var t=$("#div-register-msg");t.css("color","#000"),s()})}})}var r=s.questions.length;r===s.number_of_questions&&s.preview===!0?a():0!==r&&null!==localStorage.getItem("user")&&"maintest"===localStorage.getItem("user")&&a()}):l.html('<span class="no-exams">Sorry, no exams set for &nbsp;'+n+"</span>")}var s=sessionStorage.getItem("exams"+o),t=JSON.parse(s);null===s?$.ajax({type:"GET",url:"api/subjects/"+o,dataType:"json",success:function(n){$("#loading-exams").css("visibility","hidden"),sessionStorage.setItem("exams"+o,JSON.stringify(n)),s=sessionStorage.getItem("exams"+o),t=JSON.parse(s),e()}}):($("#loading-exams").css("visibility","hidden"),e())}var n=s.name,o=s.id,a=e,i=$("#subjects-list");i.append('<br><button class="btn btn-primary btn-subject" id="subject-'+a+'">'+n+"</button><br>");var r=$("#subject-"+a),l=$("#lead-instruction");r.on("click",function(){if(l.empty(),i.empty(),i.append('<div class="cssload-loader" id="loading-exams" style="margin-top: 10%">Loading '+n+"</div>"),screen.width>768){var e=$("#second-slash");e.append("/");var s=$("#all-subject-exams");s.append('<span class="subject-link-name" id="sub-'+a+'">'+n+"</span>")}t()})})}})}),$(function(){function e(e){var s=null;if(document.cookie&&""!==document.cookie)for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var o=jQuery.trim(t[n]);if(o.substring(0,e.length+1)==e+"="){s=decodeURIComponent(o.substring(e.length+1));break}}return s}function s(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}function t(e){var s=document.location.host,t=document.location.protocol,n="//"+s,o=t+n;return e==o||e.slice(0,o.length+1)==o+"/"||e==n||e.slice(0,n.length+1)==n+"/"||!/^(\/\/|http:|https:).*/.test(e)}var n=e("csrftoken");$.ajaxSetup({beforeSend:function(e,o){!s(o.type)&&t(o.url)&&e.setRequestHeader("X-CSRFToken",n)}})});
