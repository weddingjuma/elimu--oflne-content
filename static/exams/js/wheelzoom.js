window.wheelzoom=function(){var a={zoom:.1},b=document.createElement("canvas"),c=function(c,d){function n(a){a.style.backgroundImage='url("'+a.src+'")',a.style.backgroundRepeat="no-repeat",b.width=a.naturalWidth,b.height=a.naturalHeight,m=b.toDataURL(),a.src=m}function o(){j>0?j=0:j<f-h&&(j=f-h),k>0?k=0:k<g-i&&(k=g-i),c.style.backgroundSize=h+"px "+i+"px",c.style.backgroundPosition=j+"px "+k+"px"}function p(){h=f,i=g,j=k=0,o()}function q(a){var b=0;a.preventDefault(),a.deltaY?b=a.deltaY:a.wheelDelta&&(b=-a.wheelDelta);var d=c.getBoundingClientRect(),l=a.pageX-d.left-window.pageXOffset,m=a.pageY-d.top-window.pageYOffset,n=l-j,q=m-k,r=n/h,s=q/i;b<0?(h+=h*e.zoom,i+=i*e.zoom):(h-=h*e.zoom,i-=i*e.zoom),j=l-h*r,k=m-i*s,h<=f||i<=g?p():o()}function r(a){a.preventDefault(),j+=a.pageX-l.pageX,k+=a.pageY-l.pageY,l=a,o()}function s(){document.removeEventListener("mouseup",s),document.removeEventListener("mousemove",r)}function t(a){a.preventDefault(),l=a,document.addEventListener("mousemove",r),document.addEventListener("mouseup",s)}function u(){if(c.src!==m){var a=window.getComputedStyle(c,null);f=parseInt(a.width,10),g=parseInt(a.height,10),h=f,i=g,j=0,k=0,n(c),c.style.backgroundSize=f+"px "+g+"px",c.style.backgroundPosition="0 0",c.addEventListener("wheelzoom.reset",p),c.addEventListener("wheel",q),c.addEventListener("mousedown",t)}}if(c&&c.nodeName&&"IMG"===c.nodeName){var f,g,h,i,j,k,l,m,e={},v=function(a){c.removeEventListener("wheelzoom.destroy",v),c.removeEventListener("wheelzoom.reset",p),c.removeEventListener("load",u),c.removeEventListener("mouseup",s),c.removeEventListener("mousemove",r),c.removeEventListener("mousedown",t),c.removeEventListener("wheel",q),c.style.backgroundImage=a.backgroundImage,c.style.backgroundRepeat=a.backgroundRepeat,c.src=a.src}.bind(null,{backgroundImage:c.style.backgroundImage,backgroundRepeat:c.style.backgroundRepeat,src:c.src});c.addEventListener("wheelzoom.destroy",v),d=d||{},Object.keys(a).forEach(function(b){e[b]=void 0!==d[b]?d[b]:a[b]}),c.complete&&u(),c.addEventListener("load",u)}};return"function"!=typeof window.getComputedStyle?function(a){return a}:function(a,b){return a&&a.length?Array.prototype.forEach.call(a,c,b):a&&a.nodeName&&c(a,b),a}}();
